{
  "name": "apgms",
  "type": "module",
  "private": true,
  "version": "0.1.0",
  "workspaces": [
    "services/*",
    "webapp",
    "shared",
    "worker",
    "apps/*",
    "packages/*"
  ],
  "scripts": {
    "check:prisma-paths": "bash scripts/check-prisma-schema-paths.sh",
    "prisma:format": "pnpm exec prisma format --schema infra/prisma/schema.prisma",
    "prisma:validate": "pnpm exec prisma validate --schema infra/prisma/schema.prisma",
    "prisma:generate": "node ./scripts/ensure-linux.mjs && pnpm exec prisma generate --schema infra/prisma/schema.prisma",
    "prisma:status": "pnpm exec prisma migrate status --schema infra/prisma/schema.prisma",
    "db:migrate": "pnpm exec prisma migrate dev --schema infra/prisma/schema.prisma",
    "db:deploy": "pnpm exec prisma migrate deploy --schema infra/prisma/schema.prisma",
    "db:gen": "node ./scripts/ensure-linux.mjs && pnpm exec prisma generate --schema infra/prisma/schema.prisma",
    "db:smoke": "node ./scripts/db-smoke.mjs",
    "migrate:status": "pnpm exec prisma migrate status --schema infra/prisma/schema.prisma",
    "build": "pnpm -r build",
    "build:api-gateway": "pnpm --filter @apgms/shared build && pnpm --filter @apgms/domain-policy build && pnpm --filter @apgms/api-gateway build",
    "typecheck": "pnpm -r typecheck",
    "test:domain": "pnpm --filter @apgms/domain-policy test -- --coverage",
    "test:infra": "pnpm --filter @apgms/ledger test && pnpm --filter @apgms/api-gateway test",
    "test:ato-validator": "pnpm exec node --test ./scripts/__tests__/validate-ato-ruleset.test.mjs",
    "verify": "bash ./scripts/verify.sh",
    "validate:ato": "node ./scripts/validate-ato-ruleset.mjs",
    "test:e2e": "pnpm exec playwright test",
    "jest": "jest",
    "coverage": "pnpm jest --coverage",
    "lint": "pnpm lint:markdown",
    "lint:markdown": "pnpm exec markdownlint-cli2 -c .markdownlint.json",
    "sbom:deps": "pnpm exec license-checker-rse --json --out sbom-licenses.json",
    "sbom": "pnpm exec cyclonedx-bom -o sbom.xml . || echo \"[sbom] cyclonedx-bom failed, check sbom.xml + logs\"",
    "check:sbom": "node ./scripts/check-sbom.mjs",
    "sca": "pnpm audit --audit-level=high",
    "audit:prod": "pnpm audit --audit-level=high",
    "audit:dev": "pnpm audit --audit-level=moderate || echo \"[audit:dev] non-zero exit (dev-tool vulns only)\"",
    "scan:secrets": "gitleaks detect --no-banner --redact --report-format=sarif --report-path=gitleaks.sarif",
    "scan:fs": "trivy fs . --severity HIGH,CRITICAL --exit-code 1 --no-progress",
    "trivy": "trivy fs . --severity HIGH,CRITICAL --exit-code 1",
    "verify:no-conflicts": "node scripts/verify-no-conflicts.mjs",
    "k6:smoke": "k6 run k6/smoke.js",
    "smoke:regulator": "node scripts/regulator-smoke.mjs",
    "guard:infra-coverage": "node scripts/guard-no-infra-coverage.mjs",
    "compliance:evidence": "node scripts/collect-evidence.mjs",
    "security:rotate-keys": "node scripts/rotate-pii-keys.mjs",
    "backup:evidence-pack": "tsx scripts/export-evidence-pack.ts",
    "scan:app": "tsx scripts/crawl-app.ts",
    "check:coverage": "pnpm --filter @apgms/api-gateway run check:coverage",
    "gitleaks": "gitleaks detect --no-color --redact --exit-code 1",
    "test:a11y": "pnpm --filter @apgms/webapp test:axe",
    "a11y": "pnpm exec playwright test --grep \"@a11y\"",
    "lhci": "pnpm exec lhci autorun --config=./lighthouserc.json",
    "dev:stack": "docker compose up -d db redis tax-engine",
    "dev:stack:down": "docker compose down",
    "readiness:availability": "node ./scripts/readiness/availability.cjs",
    "readiness:k6": "node ./scripts/readiness/k6-summary.cjs",
    "readiness:log-scan": "node ./scripts/readiness/log-scan.cjs",
    "readiness:availability-and-performance": "node ./scripts/readiness/availability-and-performance.cjs",
    "readiness:all": "node ./scripts/readiness/all.cjs",
    "assess:fast": "node assessment/assessor-10of10/scripts/apgms-assess.cjs --fast --req assessment/assessor-10of10/docs/assessor/requirements.v2.json --outdir assessment/reports",
    "assess:all": "node assessment/assessor-10of10/scripts/apgms-assess.cjs --all --req assessment/assessor-10of10/docs/assessor/requirements.v2.json --outdir assessment/reports",
    "assess:production": "node assessment/assessor-10of10/scripts/apgms-assess.cjs --all --production --req assessment/assessor-10of10/docs/assessor/requirements.v2.json --outdir assessment/reports",
    "prisma:migrate": "node ./scripts/ensure-linux.mjs && pnpm exec prisma migrate deploy --schema infra/prisma/schema.prisma"
  },
  "devDependencies": {
    "@axe-core/playwright": "^4.11.0",
    "@cyclonedx/cyclonedx-npm": "^4.1.2",
    "@playwright/test": "^1.57.0",
    "@swc/core": "^1.15.8",
    "@swc/jest": "^0.2.39",
    "@types/jest": "^30.0.0",
    "@types/node": "^25.0.6",
    "@typescript-eslint/eslint-plugin": "^8.0.0",
    "@typescript-eslint/parser": "^8.0.0",
    "ajv": "^8.17.1",
    "ajv-formats": "^2.1.1",
    "bcryptjs": "^3.0.3",
    "cyclonedx-bom": "0.0.9",
    "eslint": "^9.15.0",
    "eslint-plugin-react-hooks": "^7.0.1",
    "jest": "^30.2.0",
    "jsonwebtoken": "^9.0.3",
    "markdownlint-cli2": "^0.20.0",
    "prisma": "7.2.0",
    "tinyglobby": "^0.2.15",
    "ts-jest": "^29.4.6",
    "ts-node": "^10.9.2",
    "tsx": "^4.21.0",
    "typescript": "^5.9.3"
  },
  "dependencies": {
    "@fastify/cors": "^11.2.0",
    "@prisma/client": "7.2.0",
    "argon2": "^0.44.0",
    "fastify": "^5.6.2",
    "nats": "^2.18.0",
    "uuid": "^13.0.0",
    "zod": "^4.3.5"
  },
  "pnpm": {
    "overrides": {
      "jws": "3.2.3",
      "glob": "10.5.0"
    }
  },
  "packageManager": "pnpm@9.15.9+sha512.68046141893c66fad01c079231128e9afb89ef87e2691d69e4d40eee228988295fd4682181bae55b58418c3a253bde65a505ec7c5f9403ece5cc3cd37dcf2531"
}
