# Data Governance Runbook

## Purpose and Scope
This runbook codifies the controls that underpin payroll fraud monitoring, compliance reporting, and remittance automation across the APGMS platform. It applies to the data engineering, ML operations, risk, and legal teams responsible for ingesting Australian Tax Office (ATO) feeds, performing anomaly detection, and acting on resulting alerts.

## Data Inventory and Lineage
| Dataset | Source | Downstream Consumers | Lineage & Storage Notes | Update Cadence |
| --- | --- | --- | --- | --- |
| `payg_tables_normalized.csv` | ATO PAYG withholding feed (SFTP) | Feature store (`providers/fraud/features/payg.py`), dashboards (`apps/compliance-reporting`) | Landed in raw S3 bucket `apgms-ext-ato`, versioned by ingestion date → cleansed in Delta Lake `fraud.curated_payg` → published to Snowflake mart `FIN_PAYG_MONITOR` | Nightly at 01:00 AEST |
| `merchant_risk_events` | Internal transaction ledger (`services/risk-ledger`) | Anomaly detection service (`worker/fraud_detector`), case management UI (`webapp/src/pages/RiskQueue.tsx`) | CDC replication into Kafka topic `risk.events` → persisted in warehouse table `FRAUD_MERCHANT_EVENTS` → features materialized in Redis for online scoring | Near-real-time (sub-5 min) |
| `compliance_case_actions` | Case management API (`services/case-api`) | Audit trails, fairness reporting notebook (`notebooks/fairness_audit.ipynb`) | REST ingestion → PostgreSQL `compliance.case_actions` schema → exported weekly to legal archive bucket `apgms-legal-evidence` | Hourly delta sync |

### Lineage Monitoring
* Capture lineage metadata in OpenLineage on every Spark job (`tools/lineage_capture.py`).
* Automatically reconcile expected vs. actual upstream sources weekly; discrepancies trigger PagerDuty `Data Lineage` alert.

## Data Minimization and Anonymization
* **Anonymization pipelines**: Before data enters analytics zones, apply irreversible tokenization to Tax File Numbers (TFNs) using HMAC-SHA256 with rotating keys stored in AWS KMS (`infra/kms.tf`). Email, phone, and bank account fields are masked via format-preserving hashing with last 4 digits retained for reconciliation.
* **Differential privacy for analytics**: Aggregated dashboards enforce epsilon ≤ 1.0 noise addition for counts derived from fewer than 50 employees per employer ID.
* **Access controls**: PII fields are quarantined in `fraud.sensitive_vault` and only accessible through fine-grained RBAC policies defined in Snowflake (`infra/snowflake/roles.sql`). Quarterly access reviews performed jointly by Data Governance and Security.

## Explainability and Model Transparency
* **Artifact generation**: Every fraud decision generated by `worker/fraud_detector` produces SHAP summary plots and local feature attribution JSON saved in `artifacts/explainability/<model_version>/<decision_id>.json`.
* **Retention**: Explainability artifacts retained for 24 months to satisfy ASIC audit requirements.
* **Access**: Case analysts retrieve artifacts via the Risk Queue UI, which calls `providers/explainability-service` to render the SHAP visualization alongside the case record.
* **Monitoring cadence**: Spot-check 10% of production fraud decisions weekly for attribution drift; ML governance board reviews full reports monthly.

## Fairness Assurance
* **Protected class proxies**: Use `merchant_industry` and `employee_income_band` as fairness slices.
* **Bias metrics**: Monitor disparate impact ratio, false positive/negative rate parity, and equal opportunity difference.
* **Cadence**: Automated fairness job runs every Sunday 03:00 AEST using latest weekly snapshot; quarterly deep-dive with Risk & Compliance to recalibrate thresholds.
* **Escalation**: Any metric breaching ±5% tolerance triggers a `FairnessIncident` in Jira with 48-hour resolution SLA and legal notification.

## Governance Matrix – Human-in-the-Loop Controls
| Decision Point | Automated System | Human Reviewer | Trigger Threshold | Review Window | Escalation Path | Audit Evidence |
| --- | --- | --- | --- | --- | --- | --- |
| High-risk fraud hold on remittance | `worker/fraud_detector` | Senior Fraud Analyst | Risk score ≥ 0.85 or anomaly z-score ≥ 3 | Within 4 business hours | Escalate to Fraud Operations Manager if unresolved in 8 hours; notify Compliance Director if >24 hours | Case notes, SHAP artifacts, analyst decision log, Jira ticket ID |
| Regulatory compliance breach detection | `services/compliance-monitor` | Compliance Officer | Breach severity `HIGH` or repeated `MEDIUM` twice in 30 days | Within 1 business day | Escalate to Head of Compliance; legal counsel review for reportable breaches | Compliance case record, evidence package in `apgms-legal-evidence`, sign-off email |
| Large remittance release after manual hold | `payments-orchestrator` | Treasury Specialist | Remittance amount ≥ AUD 5M | Same business day | Escalate to Treasury Lead; CFO approval required if > AUD 20M | Approval workflow export, dual-authorization log, payment release confirmation |
| Suspicious employee reimbursement | `ml-expense-screener` | HR Compliance Partner | ML flag probability ≥ 0.7 with >2 supporting anomalies | Within 2 business days | Escalate to HR Director and Legal for termination consideration | HR case file, evidence screenshots, reviewer attestation form |

## Resilience and Continuity Scenarios
### Integration Outage (ATO SFTP Unavailable)
* **Detection**: Ingestion DAG fails health check; PagerDuty `ATO Integration` alert.
* **Manual Lodgment Workflow**:
  1. Treasury downloads latest available PAYG tables from ATO portal manually.
  2. Data Engineering uploads file via secured console script `scripts/manual_ingest_payg.py --source portal`.
  3. Governance lead signs off on checksum verification and lineage entry.
* **Queued Remittance Handling**: Payments queued in `payments_orchestrator.outbox`; release held until ingestion completes. Finance receives hourly status digest.
* **Recovery SLA**: Restore automated ingestion within 12 hours; backlog reprocessing completed within 4 additional hours.

### ML Service Downtime (`worker/fraud_detector`)
* **Detection**: Kubernetes readiness probe failure and zero scoring throughput for 5 minutes triggers `ML Service` incident.
* **Manual Lodgment Workflow**:
  1. Switch feature store routing to rules-based fallback (`providers/fraud/rules_engine.py`).
  2. Fraud analysts conduct manual triage using latest explainability artifacts and transaction summaries exported via `scripts/export_manual_review.py`.
  3. Compliance records manual decisions in `compliance_case_actions` with tag `ml-outage`.
* **Queued Remittance Handling**: Remittances exceeding risk score threshold are parked in `fraud_hold_queue`; Treasury may release low-risk payments (<0.4 risk score) with dual approval.
* **Recovery SLA**: Restore ML scoring within 4 hours; reconcile all manual decisions within 24 hours of service restoration.

## Policy-Driven Patent Claim Amendments
* Align patent claims for the "Adaptive Payroll Governance Management System" to explicitly cover anonymization (tokenized TFNs, differential privacy guardrails), explainability retention (SHAP artifacts linked to case workflows), fairness auditing (automated bias metrics with escalation), and resilience orchestration (manual lodgment workflows for regulatory integrations and ML failover).
* Amend independent claim 1 to state that the system orchestrates anonymized ingestion, lineage tracking, and human-in-the-loop governance for payroll remittances, incorporating explainability evidence and fairness monitoring as integral components.
* Add dependent claims specifying (a) rotating cryptographic keys for PII tokenization, (b) weekly fairness audits tied to compliance escalation, and (c) recovery SLAs for integration and ML outages leveraging queued remittance buffers.
* Circulate updated draft claims to Legal (`legal@apgms.example`) and the IP counsel distribution list via Confluence page `Legal/Patents/APGMS-Governance` with request for feedback by end of week.

## Monitoring and Reporting Cadence Summary
| Control Area | Owner | Cadence |
| --- | --- | --- |
| Lineage reconciliation | Data Engineering Lead | Weekly |
| Access review for sensitive vault | Security & Governance | Quarterly |
| Explainability spot-check | ML Governance Board | Weekly (10% sample) |
| Fairness audit job | Risk Analytics | Weekly (Sunday 03:00 AEST) |
| Governance board review | Risk, Compliance, Legal | Monthly |
| Resilience scenario tabletop | Ops & Treasury | Semi-annual |

## Revision History
| Date | Author | Changes |
| --- | --- | --- |
| 2025-01-04 | Data Governance Team | Initial creation of anonymization, lineage, explainability, fairness, resilience, and patent amendment guidelines. |
