# OWASP ASVS L2

The table below tracks our current coverage against a short list of high-priority ASVS Level 2 controls. Rows marked with checkboxes capture planned hardening work without over-stating our present posture.

| ASVS Control | Current Implementation | Planned Enhancements | Owner | Evidence |
| --- | --- | --- | --- | --- |
| 2.1.1 Verify that all pages and resources require authentication except those specifically intended to be public. | Admin-only endpoints in the API gateway check for the `x-admin-token` header and enforce token comparison against `ADMIN_TOKEN`, blocking access when the secret is missing or incorrect (`services/api-gateway/src/app.ts`). | - [ ] Replace the static header guard with an IAM-backed session that supports rotation and revocation (TBD – create PR). | Platform Security (service owners) | [`services/api-gateway/src/app.ts`](../../services/api-gateway/src/app.ts)<br>[Security workflow](https://github.com/matthewdau85/APGMS-Final/actions/workflows/security.yml) |
| 9.1.1 Verify that sensitive data is stored, transmitted, and processed securely. | TFNs and other PII are tokenised with per-salt HMACs and encrypted using AES-256-GCM prior to storage (`services/api-gateway/src/lib/pii.ts`), with regression tests covering the tokeniser (`services/api-gateway/test/pii.spec.ts`). | - [ ] Automate PII provider bootstrapping so salts and encryption keys are sourced from a managed KMS rather than local configuration (TBD – create PR). | Data Protection (PII working group) | [`services/api-gateway/src/lib/pii.ts`](../../services/api-gateway/src/lib/pii.ts)<br>[`services/api-gateway/test/pii.spec.ts`](../../services/api-gateway/test/pii.spec.ts)<br>[CI workflow](https://github.com/matthewdau85/APGMS-Final/actions/workflows/ci.yml) |
| 10.3.1 Verify that log data is protected from tampering and unauthorised access. | Application logs mask secrets before emission via shared masking utilities to limit leakage in log sinks (`shared/src/masking.ts`, used in `services/api-gateway/src/app.ts`). | - [ ] Forward structured application logs into the central SIEM with integrity controls and access reviews (TBD – create PR). | Observability & Security Operations | [`shared/src/masking.ts`](../../shared/src/masking.ts)<br>[`services/api-gateway/src/app.ts`](../../services/api-gateway/src/app.ts)<br>[CI workflow](https://github.com/matthewdau85/APGMS-Final/actions/workflows/ci.yml) |

Additional controls will be documented as they are implemented so that we can show incremental, evidence-backed improvements over time.
