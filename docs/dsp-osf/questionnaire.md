# DSP OSF questionnaire (draft responses)

_Last refreshed: 2025-11-16. The team attempted to download the latest OSF control matrix from softwaredevelopers.ato.gov.au on the same date, but the site responded with an Envoy 503. Until the ATO publishes an updated checklist, we continue to reference the February 2023 matrix retained in the compliance workspace._

| Section | OSF prompt | Response summary | Evidence |
| --- | --- | --- | --- |
| Governance | Identify your primary security contact and describe how vulnerabilities are reported. | Security@yourdomain.example is monitored during business hours with a 2-day SLA, and `SECURITY.md` documents acknowledgement/mitigation timelines plus coordination with the NDB runbook and TFN SOP. | `SECURITY.md`, `runbooks/ndb.md`, `docs/security/TFN-SOP.md` |
| Governance | Describe how you assign ownership of privileged operations and regulatory submissions. | Admin controls, compliance monitoring, and designated-account runbooks each name security/ops owners, the evidence folder path, and the submission process that flows into `status/dsp-osf.md`. | `docs/runbooks/admin-controls.md`, `docs/runbooks/compliance-monitoring.md`, `status/dsp-osf.md` |
| IAM | Demonstrate MFA coverage for privileged access (BAS lodgment, alert resolution, enrolment). | MFA enrolment toggles the `mfaEnabled` claim in `/auth/login`, BAS/alert routes reject requests until `verify-mfa` succeeds, and the portal surfaces the same challenges before executing privileged actions. | `services/api-gateway/src/auth.ts`, `services/api-gateway/src/routes/auth.ts`, `webapp/src/BasPage.tsx`, `webapp/src/AlertsPage.tsx`, `webapp/src/SecurityPage.tsx` |
| IAM | Explain how sessions are authenticated and revoked. | Fastify `createAuthGuard` validates RS256/HS256 JWTs with issuer/audience checks, attaches the principal to `request.user`, and honours per-route role/MFA validators; JWT secrets/JWKS live in the deployment manifest and can be rotated via the secrets runbook. | `services/api-gateway/src/auth.ts`, `docker-compose.yml`, `docs/runbooks/secrets-management.md` |
| Logging & monitoring | Provide evidence of audit logging, correlation IDs, and monitoring hooks. | `recordAuditLog` chains SHA-256 hashes per org, admin delete/export routes emit `security_event` lines enriched with `x-correlation-id`, and ops runbooks direct teams to feed those logs/metrics into their SIEM + Prometheus dashboards (LOG-01/LOG-02). | `services/api-gateway/src/lib/audit.ts`, `services/api-gateway/src/routes/admin.data.js`, `shared/src/security-log.ts`, `docs/runbooks/admin-controls.md`, `docs/runbooks/compliance-monitoring.md`, `docs/security/ASVS-mapping.md` |
| Cryptography & secrets | Outline your encryption/key rotation process. | `pnpm security:rotate-keys --write-env .env` (backed by `scripts/rotate-pii-keys.mjs`) issues new RSA JWKS entries and PII envelope keys, while the secrets runbook documents where to store outputs, restart services, and archive evidence packs; the TFN SOP explains how temporary TFN artefacts are handled. | `package.json`, `scripts/rotate-pii-keys.mjs`, `docs/runbooks/secrets-management.md`, `docs/security/TFN-SOP.md` |
| Compliance monitoring | Show how you monitor obligations and designated accounts. | `/ingest/*` feeds, `/compliance/status`, and the nightly `designated-reconciliation` job keep PAYGW/GST buffers aligned; the runbook explains how to capture shortfalls, penalties, and remediation evidence for OSF submissions. | `worker/src/jobs/designated-reconciliation.ts`, `docs/runbooks/compliance-monitoring.md` |
| Incident response | Describe your OAIC/NDB playbook. | The NDB runbook covers confirmation, containment, OAIC portal templates, customer notifications, and post-incident reviews, and it is linked from `SECURITY.md` for every severity-1 issue. | `runbooks/ndb.md`, `SECURITY.md` |
| Infrastructure & deployment | Explain where key services run and how secrets/config are enforced. | `docker-compose.yml` scopes Postgres/Redis/tax-engine/API to `apgmsnet`, enumerates required environment variables, and pairs with IaC plans to pin future production workloads to AU regions. | `docker-compose.yml`, `docs/runbooks/compliance-monitoring.md` |
| Open gaps | List outstanding OSF actions and remediation timelines. | MFA full enforcement, SIEM forwarding for `security_event`, and AU-region attestation are tracked inside the control matrix and status tracker with owners/dates so auditors can see progress. | `docs/compliance/dsp-operational-framework.md`, `status/dsp-osf.md` |

## Submission workflow
1. Update this file with the latest answers before each OSF submission window.
2. Export to PDF and save in `artifacts/compliance/osf/questionnaire-<date>.pdf` alongside log excerpts, screenshots, or monitoring exports referenced above.
3. Notify the compliance mailing list with the submission ID, attach the exported evidence, and record the next review date in `status/dsp-osf.md`.
