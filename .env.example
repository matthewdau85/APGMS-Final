CORS_ALLOWED_ORIGINS=http://localhost:5173,http://127.0.0.1:5173

DATABASE_URL=postgresql://postgres:postgres@db:5432/apgms?schema=public
SHADOW_DATABASE_URL=postgresql://postgres:postgres@db:5432/apgms_shadow?schema=public
REDIS_URL=redis://redis:6379
TAX_ENGINE_URL=http://tax-engine:8000

PORT=3000
WEBAPP_PORT=5173

AUTH_AUDIENCE=urn:apgms:prod
AUTH_ISSUER=urn:apgms:issuer
AUTH_DEV_SECRET=local-dev-shared-secret-change-me
# AUTH_JWKS should contain a JSON JWK Set; replace the sample modulus with your own secure material.
AUTH_JWKS={"keys":[{"kid":"local","alg":"RS256","kty":"RSA","n":"replace-with-base64url-modulus","e":"AQAB"}]}

API_RATE_LIMIT_MAX=120
API_RATE_LIMIT_WINDOW=1 minute
AUTH_FAILURE_THRESHOLD=5

PASSWORD_PEPPER=dev-pepper
PASSWORD_MEM_KIB=65536
PASSWORD_TIME_COST=3
PASSWORD_PARALLELISM=1
SECRETS_PROVIDER=env # or vault
# VAULT_ADDR=http://127.0.0.1:8200
# VAULT_TOKEN=changeme
# VAULT_NAMESPACE=

PII_KEYS=[{"kid":"local","material":"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQE="}]
# PII_KEYS_SECRET_PATH=secret/data/apgms/pii-keys
PII_ACTIVE_KEY=local
PII_SALTS=[{"sid":"local","secret":"AgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI="}]
# PII_SALTS_SECRET_PATH=secret/data/apgms/pii-salts
PII_ACTIVE_SALT=local
ENCRYPTION_MASTER_KEY=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=

REGULATOR_ACCESS_CODE=regulator-dev-code
REGULATOR_JWT_AUDIENCE=urn:apgms:regulator
REGULATOR_SESSION_TTL_MINUTES=60

WEBAUTHN_RP_ID=localhost
WEBAUTHN_RP_NAME=APGMS Admin
WEBAUTHN_ORIGIN=http://localhost:5173

REQUIRE_TLS=false
